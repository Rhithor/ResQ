// Prisma schema for ResQ backend
// Uses the existing DATABASE_URL in .env (Postgres / Supabase)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model victim {
  id             String                                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name           String
  email          String                                 @unique
  password       String
  emergency_type String
  status         String?                                @default("open")
  location       Unsupported("geography(Point, 4326)")?
  created_at     DateTime?                              @default(now()) @db.Timestamptz(6)
  disasterId     String?                                @db.Uuid
  disaster       disaster?                              @relation(fields: [disasterId], references: [id])
}

model volunteer {
  id            String                                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String
  email         String                                 @unique
  password      String
  resource_type String
  is_available  Boolean?                               @default(true)
  location      Unsupported("geography(Point, 4326)")?
  last_updated  DateTime?                              @default(now()) @db.Timestamptz(6)
}

model disaster {
  id          String                                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String
  type        String
  location    Unsupported("geography(Point, 4326)")?
  description String?
  is_active   Boolean                                @default(true)
  createdAt   DateTime                               @default(now())
  victims     victim[]
}
